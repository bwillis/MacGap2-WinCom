<!DOCTYPE html>
<html>
    <head>
        <title>MacGap</title>
        <style type="text/css" media="screen">
            html, body {
                background: #FFF;
                padding: 20px;
                margin: 0;
                overflow: hidden;
                -webkit-user-select: none;
            }
        
        h1 {
            color: #E0E0E0;
            margin: 18% 0;
            text-align: center;
            font-family: helvetica;
        }
        
        #windowChannel {
            width: 100%;
            height: 200px;
        }
        </style>
        
    </head>
    <body>
        
        <script type="text/javascript" charset="utf-8">
            window.onload = function(){
                document.getElementById('windowChannel').addEventListener('input', function() {
                    localStorage['windowChannel'] = this.value;
                });
                                                            
                window.addEventListener('storage', function (e) {
                    // e.key
                     document.getElementById('windowChannel').value = e.newValue;
                });
                                                                           
                document.getElementById('newWindow').addEventListener('click', function(){
                    MacGap.Window.open({url: 'public/index.html'});
                });
                
                document.getElementById('windowChannel').value = localStorage['windowChannel'];
            };
        </script>
        
        <h2>Create a new window</h2>
        <p>
            Use the button below to create another identical window.
        </p>
        <button id='newWindow'>Open New Window</button>
        <br/>
        <h2>Cross window sync'd localStorage</h2>
        <p>
            Text entered in the text area will be set in localStorage. Other windows will be subscribed to changes
        </p>
        <textarea id='windowChannel'></textarea>
    </body>
</html>